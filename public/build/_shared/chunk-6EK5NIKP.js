import{c as w,d as h}from"/build/_shared/chunk-7UEYUE33.js";var a=w(h()),u=new Map;function S(e,r){if(a.useSyncExternalStore===void 0)throw new TypeError('You are using React 17 or below. Install with "npm install use-local-storage-state@17".');let s=r?.defaultValue;if(typeof window>"u")return[s,()=>{},{isPersistent:!0,removeItem:()=>{}}];let o=r?.serializer;return p(e,s,r?.storageSync,o?.parse,o?.stringify)}function p(e,r,s=!0,o=I,i=JSON.stringify){let l=(0,a.useRef)(r).current;if(!u.has(e)&&l!==void 0&&localStorage.getItem(e)===null)try{localStorage.setItem(e,i(l))}catch{}let c=(0,a.useRef)({item:null,parsed:l}),d=(0,a.useSyncExternalStore)((0,a.useCallback)(t=>{let n=f=>{e===f&&t()};return m.add(n),()=>{m.delete(n)}},[e]),()=>{let t=localStorage.getItem(e);if(u.has(e))c.current={item:t,parsed:u.get(e)};else if(t!==c.current.item){let n;try{n=t===null?l:o(t)}catch{n=l}c.current={item:t,parsed:n}}return c.current.parsed},()=>l),v=(0,a.useCallback)(t=>{let n=t instanceof Function?t(c.current.parsed):t;try{localStorage.setItem(e,i(n)),u.delete(e)}catch{u.set(e,n)}g(e)},[e,i]);return(0,a.useEffect)(()=>{if(!s)return;let t=n=>{n.storageArea===localStorage&&n.key===e&&g(e)};return window.addEventListener("storage",t),()=>window.removeEventListener("storage",t)},[e,s]),(0,a.useMemo)(()=>[d,v,{isPersistent:d===l||!u.has(e),removeItem(){u.delete(e),localStorage.removeItem(e),g(e)}}],[e,v,d,l])}var m=new Set;function g(e){for(let r of[...m])r(e)}function I(e){return e==="undefined"?void 0:JSON.parse(e)}var L=S;export{L as a};
